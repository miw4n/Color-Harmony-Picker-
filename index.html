<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ðŸŽ¨ Color Harmony Picker â€” HEX / RGB / HSL / CMYK / HSV</title>
  <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="miw4n" data-color="#FFDD00" data-emoji="ðŸ§‹"  data-font="Cookie" data-text="Buy me a bubble tea" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>

  <style>
    :root {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    body {
      background: #f4f4f4;
      color: #222;
      max-width: 980px;
      margin: 40px auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      font-size: 26px;
      margin-bottom: 16px;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 5px 18px rgba(0,0,0,0.08);
      padding: 20px;
      margin-bottom: 20px;
    }
    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
    }
    input[type=color] {
      width: 100px;
      height: 50px;
      border: none;
      cursor: pointer;
      background: none;
    }
    input[type=text] {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 120px;
      text-align: center;
    }
    select, button {
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #eee;
      cursor: pointer;
    }
    button:hover { background: #ddd; }
    .values {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 10px;
      text-align: center;
      margin-top: 12px;
    }
    .color-preview {
      width: 100%;
      height: 60px;
      border-radius: 8px;
      margin-bottom: 6px;
      border: 1px solid #ccc;
    }
    .palette {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 20px;
    }
    .tile {
      border-radius: 8px;
      text-align: center;
      color: #222;
      padding: 10px;
      background: #fff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .copy-btn {
      border: none;
      background: #007bff;
      color: white;
      border-radius: 6px;
      padding: 5px 8px;
      margin-top: 6px;
      cursor: pointer;
      font-size: 12px;
    }
    .copy-btn:hover { background: #0056b3; }
    footer {
      text-align: center;
      font-size: 13px;
      color: #777;
      margin-top: 40px;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¨ Color Harmony Picker</h1>

  <div class="card">
    <div class="row">
      <input type="color" id="colorPicker" value="#3f51b5">
      <input type="text" id="hexInput" value="#3f51b5" maxlength="7">
      <select id="mode">
        <option value="complementary">Complementary</option>
        <option value="analogous">Analogous</option>
        <option value="triadic">Triadic</option>
        <option value="tetradic">Tetradic</option>
        <option value="monochrome">Monochrome</option>
        <option value="split">Split Complementary</option>
        <option value="square">Square</option>
      </select>
      <button id="randomBtn">Random ðŸŽ²</button>
      <button id="exportJSON">Export JSON</button>
      <button id="exportACO">Export .ACO</button>
    </div>

    <div class="values" id="colorValues"></div>
  </div>

  <div class="card">
    <h3>ðŸŽ¨ Palette Preview</h3>
    <div class="palette" id="palette"></div>
  </div>

  <footer>100 % client-side â€” no data uploaded ðŸŒˆ</footer>

  <script>
    const picker = document.getElementById('colorPicker');
    const hexInput = document.getElementById('hexInput');
    const modeEl = document.getElementById('mode');
    const valuesEl = document.getElementById('colorValues');
    const paletteEl = document.getElementById('palette');
    const randomBtn = document.getElementById('randomBtn');
    const exportJSON = document.getElementById('exportJSON');
    const exportACO = document.getElementById('exportACO');

    // --- Conversion functions ---
    function hexToRgb(hex){hex=hex.replace('#','');if(hex.length===3)hex=hex.split('').map(c=>c+c).join('');const n=parseInt(hex,16);return{r:(n>>16)&255,g:(n>>8)&255,b:n&255}}
    function rgbToHex(r,g,b){return"#"+[r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('')}
    function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const max=Math.max(r,g,b),min=Math.min(r,g,b);let h,s,l=(max+min)/2;if(max===min){h=s=0;}else{const d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h*=60;}return{h:Math.round(h),s:Math.round(s*100),l:Math.round(l*100)}}
    function hslToRgb(h,s,l){s/=100;l/=100;const k=n=>(n+h/30)%12;const a=s*Math.min(l,1-l);const f=n=>l-a*Math.max(-1,Math.min(k(n)-3,Math.min(9-k(n),1)));return{r:Math.round(255*f(0)),g:Math.round(255*f(8)),b:Math.round(255*f(4))}}
    function rgbToCmyk(r,g,b){let c=1-r/255,m=1-g/255,y=1-b/255;const k=Math.min(c,m,y);if(k===1)return{c:0,m:0,y:0,k:100};c=(c-k)/(1-k);m=(m-k)/(1-k);y=(y-k)/(1-k);return{c:Math.round(c*100),m:Math.round(m*100),y:Math.round(y*100),k:Math.round(k*100)}}
    function rgbToHsv(r,g,b){r/=255;g/=255;b/=255;const max=Math.max(r,g,b),min=Math.min(r,g,b);const d=max-min;let h,s=max===0?0:d/max,v=max;switch(max){case min:h=0;break;case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;}h=Math.round(h*60);return{h,s:Math.round(s*100),v:Math.round(v*100)}}

    // --- Update Color ---
    function updateColor(hex){
      hexInput.value=hex;picker.value=hex;
      const {r,g,b}=hexToRgb(hex);
      const hsl=rgbToHsl(r,g,b);
      const hsv=rgbToHsv(r,g,b);
      const cmyk=rgbToCmyk(r,g,b);
      valuesEl.innerHTML=`
        <div><div class="color-preview" style="background:${hex}"></div><strong>HEX:</strong> ${hex}</div>
        <div><strong>RGB:</strong> ${r}, ${g}, ${b}</div>
        <div><strong>HSL:</strong> ${hsl.h}, ${hsl.s}%, ${hsl.l}%</div>
        <div><strong>HSV:</strong> ${hsv.h}, ${hsv.s}%, ${hsv.v}%</div>
        <div><strong>CMYK:</strong> ${cmyk.c}%, ${cmyk.m}%, ${cmyk.y}%, ${cmyk.k}%</div>
      `;
      generatePalette(hsl);
    }

    // --- Palette Generator ---
    function generatePalette(hsl){
      const mode = modeEl.value;
      let harmonies = [];
      switch(mode){
        case 'complementary':
          harmonies = [{label:'Base',h:hsl.h},{label:'Complementary',h:(hsl.h+180)%360}];break;
        case 'analogous':
          harmonies = [
            {label:'Analogous -30Â°',h:(hsl.h-30+360)%360},
            {label:'Base',h:hsl.h},
            {label:'Analogous +30Â°',h:(hsl.h+30)%360}
          ];break;
        case 'triadic':
          harmonies = [
            {label:'Triadic 1',h:hsl.h},
            {label:'Triadic 2',h:(hsl.h+120)%360},
            {label:'Triadic 3',h:(hsl.h+240)%360}
          ];break;
        case 'tetradic':
          harmonies = [
            {label:'Tetradic 1',h:hsl.h},
            {label:'Tetradic 2',h:(hsl.h+90)%360},
            {label:'Tetradic 3',h:(hsl.h+180)%360},
            {label:'Tetradic 4',h:(hsl.h+270)%360}
          ];break;
        case 'monochrome':
          harmonies = [
            {label:'Base',h:hsl.h,l:hsl.l},
            {label:'Light',h:hsl.h,l:Math.min(90,hsl.l+20)},
            {label:'Dark',h:hsl.h,l:Math.max(10,hsl.l-20)}
          ];break;
        case 'split':
          harmonies = [
            {label:'Base',h:hsl.h},
            {label:'Split +150Â°',h:(hsl.h+150)%360},
            {label:'Split -150Â°',h:(hsl.h-150+360)%360}
          ];break;
        case 'square':
          harmonies = [
            {label:'Square 1',h:hsl.h},
            {label:'Square 2',h:(hsl.h+90)%360},
            {label:'Square 3',h:(hsl.h+180)%360},
            {label:'Square 4',h:(hsl.h+270)%360}
          ];break;
      }

      paletteEl.innerHTML = harmonies.map(h=>{
        const rgb=hslToRgb(h.h||hsl.h,hsl.s,h.l||hsl.l);
        const hex=rgbToHex(rgb.r,rgb.g,rgb.b);
        return `<div class="tile">
          <div class="color-preview" style="background:${hex}"></div>
          <strong>${h.label}</strong><br>${hex}<br>
          <button class="copy-btn" onclick="navigator.clipboard.writeText('${hex}')">Copy</button>
        </div>`;
      }).join('');
    }

    // --- Exporters ---
    exportJSON.addEventListener('click',()=>{
      const colors=[...paletteEl.querySelectorAll('.tile strong')].map((_,i)=>{
        const hex=paletteEl.querySelectorAll('.tile')[i].querySelector('.color-preview').style.background;
        return hex;
      });
      const blob=new Blob([JSON.stringify(colors,null,2)],{type:'application/json'});
      const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='palette.json';a.click();
    });

    exportACO.addEventListener('click',()=>{
      const tiles=[...paletteEl.querySelectorAll('.color-preview')];
      const colors=tiles.map(t=>hexToRgb(t.style.background));
      const buf=new ArrayBuffer(4+colors.length*10);
      const view=new DataView(buf);
      view.setUint16(0,1);view.setUint16(2,colors.length);
      let offset=4;
      colors.forEach(c=>{
        view.setUint16(offset,0);offset+=2;
        view.setUint16(offset,Math.round(c.r/255*65535));offset+=2;
        view.setUint16(offset,Math.round(c.g/255*65535));offset+=2;
        view.setUint16(offset,Math.round(c.b/255*65535));offset+=2;
        view.setUint16(offset,0);offset+=2;
      });
      const blob=new Blob([buf],{type:'application/octet-stream'});
      const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='palette.aco';a.click();
    });

    // --- Events ---
    picker.addEventListener('input', e => updateColor(e.target.value));
    hexInput.addEventListener('input', e => {
      const val=e.target.value.trim();
      if(/^#([0-9A-F]{3}){1,2}$/i.test(val)) updateColor(val);
    });
    randomBtn.addEventListener('click', ()=>{
      const hex = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6,'0');
      updateColor(hex);
    });
    modeEl.addEventListener('change', ()=>updateColor(picker.value));

    updateColor('#3f51b5');
  </script>
</body>
</html>
